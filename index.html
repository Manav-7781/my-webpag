<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Word to PDF Converter (CloudConvert)</title>
    <style>
        #uploadSection {
            margin-top: 20px;
        }
        #fileInput {
            margin-bottom: 10px;
        }
    </style>
</head>
<body>

    <h1>Upload Word File and Convert to PDF</h1>

    <!-- File Upload Section -->
    <div id="uploadSection">
        <input type="file" id="fileInput" accept=".docx" />
        <br>
        <button id="convertBtn" disabled>Convert to PDF</button>
    </div>

    <div id="message"></div>

    <script>
        const apiKey = 'YOUR_CLOUDCONVERT_API_KEY';  // Insert your CloudConvert API key here
        let wordFile = null;

        // Handle file input and store the file
        document.getElementById('fileInput').addEventListener('change', function(event) {
            const file = event.target.files[0];
            
            if (file && file.name.endsWith('.docx')) {
                wordFile = file;
                document.getElementById('message').innerText = 'Word file selected: ' + file.name;
                document.getElementById('convertBtn').disabled = false;  // Enable convert button
            } else {
                document.getElementById('message').innerText = 'Please upload a valid .docx file.';
                document.getElementById('convertBtn').disabled = true;
            }
        });

        // Convert to PDF using CloudConvert API
        document.getElementById('convertBtn').addEventListener('click', async function() {
            if (wordFile) {
                document.getElementById('message').innerText = 'Converting file to PDF...';

                try {
                    const formData = new FormData();
                    formData.append('file', wordFile);
                    
                    // Make API request to CloudConvert for conversion
                    const response = await fetch('https://api.cloudconvert.com/v2/convert', {
                        method: 'POST',
                        headers: {
                            Authorization: `Bearer ${apiKey}`,
                        },
                        body: formData
                    });

                    const result = await response.json();

                    if (response.ok) {
                        // Provide download link to user
                        document.getElementById('message').innerHTML = `<a href="${result.url}" target="_blank">Download your PDF</a>`;
                    } else {
                        document.getElementById('message').innerText = 'Error converting the file.';
                    }
                } catch (err) {
                    document.getElementById('message').innerText = 'An error occurred during the conversion process.';
                    console.error(err);
                }
            }
        });
    </script>

</body>
</html>
